
<!DOCTYPE html>
<html>


<!-- Mirrored from www.javascriptya.com.ar/nodejsya/detalleconcepto.php?punto=4&codigo=4&inicio=0 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 15 Sep 2015 14:49:34 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=ISO-8859-1" /><!-- /Added by HTTrack -->
<head>
<title>Módulo para administrar el sistema de archivos: fs</title>
<meta http-equiv="content-type" content="text/html; charset=iso-8859-1">
<meta name="keywords" content="c++, programación, tutorial, nodejs">
<meta name="description" content="El objetivo de este tutorial 
es presentar los conceptos básicos de NodeJS.">

<meta name="author" content="Diego Moisset">

<link rel="stylesheet" type="text/css" href="principal.css">

<style>
html,body {
	background-color: #D3E9D0;
	font-family: sans-serif,arial;
	font-size: 1em;
}

h1 {
	font-size: 14pt;
	margin: 0%;
}
.recuadro {
  background-color:#ffffcc;
  text-align:left;
  font-family:courier;
  font-size:1.2em;
  border-width:0;
  padding:5px;
  border: 1px dotted #ffaa00;
  overflow:scroll;
  float:both;
  width:940px;
  overflow-y:hidden;
}

.recuadrooculto {
  background-color:#ffffcc;
  text-align:left;
  font-family:courier;

  border-width:0;
  padding:5px;

  border: 1px dotted #ffaa00;
  display: none;
}

 li {
    padding:10px;
 }
</style>

</head>

<body>


<div style="background-color: #AED7A8;width: 950px;	margin-left: auto;margin-right: auto;border-radius:7px;padding:10px">
<h1>4 - Módulo para administrar el sistema de archivos: fs</h1></div>

<br>

<div style="background-color: #AED7A8;width: 950px;	border-radius:7px;padding:10px;margin-left: auto;margin-right: auto">

<div style="display:block;float:left;margin: 5px;"> 
<script type="text/javascript"><!--
google_ad_client = "pub-4669394804436935";
/* 300x250, creado 6/11/08 novi */
google_ad_slot = "7481492727";
google_ad_width = 300;
google_ad_height = 250;
//-->
</script>
<script type="text/javascript"
src="../../pagead2.googlesyndication.com/pagead/f.txt">
</script>

</div> 

<p>Ya sabemos como crear un módulo mínimo, como consumirlo a dicho módulo y también como consumir módulos que vienen por defecto en Node.js.</p>
<p>Ahora veremos un segundo módulo que viene implementado en Node.js por defecto y nos permite acceder al sistema de archivos para poder leer sus contenidos y crear otros archivos o carpetas.</p>
<p>Tenemos que poner mucho cuidado en entender el concepto de programación asincrónica que propone la plataforma de Node.js</p>
<p>La programación asincrónica busca no detener la ejecución del programa en forma completa por actividades que requieren mucho tiempo (una analogía es imaginar que nuestro entorno Node.js es un "mozo de restaurante" que va a una mesa y toma el pedido y lo envía a la cocina, la eleboración del pedido toma su tiempo pero el mozo no se queda congelado hasta que la cocina le avisa que el pedido está preparado sino que sigue tomando pedidos en otras mesas)</p>
<p>El módulo de administración de archivos "fs" implementa la programación asincrónica para procesar su creación, lectura, modificación, borrado etc.</p>
<h3>Creación de un archivo de texto.</h3>
<p>Creemos un archivo llamado ejercicio5.js:</p>
<pre class="recuadro">
var fs=require('fs');

fs.writeFile('./archivo1.txt','línea 1\nLínea 2',function(error){
    if (error)
        console.log(error);
    else
        console.log('El archivo fue creado');
});

console.log('última línea del programa');
</pre>

<p>Es importante tener en cuenta que cuando ejecutamos este programa aparece en pantalla primero el mensaje:</p>
<pre>
última línea del programa
</pre>
<p>antes que:</p>
<pre>
El archivo fue creado
</pre>
<p><img src="imagentema/foto013.jpg" border="0" alt="modulo fs writeFile node.io"></p>
<p>Expliquemos como funciona el código de este programa, primero requerimos el módulo 'fs':</p>
<pre>
var fs=require('fs');
</pre>
<p>Llamamos a la función writeFile a través de la variable fs. Esta función tiene tres parámetros:</p>

<ul>
  <li>El primer parámetro es el nombre del archivo de texto a crear. Indicamos el path donde debe crearse (en este caso se crea en la misma carpeta donde se encuentra nuestro programa ejercicio5.js)</li>
  <li>El segundo parámetro es el string a grabar en el archivo de texto (mediante los caracteres \n generamos el salto de línea en el archivo de texto)</li>
  <li>Finalmente el tercer parámetro es una función anónima que será llamada desde el interior de la función writeFile cuando haya terminado de crear y grabar el string en el archivo de texto. La función recibe como parámetro un objeto literal con el error en caso de no poderse crear el archivo, en el caso de haber podido crear el archivo retorna en la variable error el valor null.<br>
El if se verifica verdadero si en la variable error viene un objeto sino con el valor null almacenado en el parámetro error se ejecuta el bloque del else donde mostramos el mensaje de que el archivo fue creado.
 </li>
</ul>

<p>La programación asincrónica podemos ver que sucede al mostrar el mensaje 'última línea del programa' antes de informarnos que el archivo fue creado. Es decir que cuando llamamos a la función writeFile el programa no se detiene en esta línea hasta que el archivo se crea sino que continúa con las siguientes instrucciones.</p>
<p>En este programita en particular no tiene grandes ventajas utilizar la programación asíncrona ya que luego de llamar a la función writeFile solo procedemos a mostrar un mensaje por la consola, pero en otras circunstancias podríamos estar ejecutando más actividades que no dependieran de la creación de dicho archivo (por ejemplo ordenando un vector en memoria)</p>

<h3>Lectura de un archivo de texto.</h3>
<p>Creemos un archivo llamado ejercicio6.js:</p>
<pre class="recuadro">
var fs=require('fs');

fs.readFile('./archivo1.txt',function(error,datos){
    if (error) {
        console.log(error);
    }	
    else {
        console.log(datos.toString());
    }
});

console.log('última línea del programa');
</pre>
<p>El resultado de ejecutar este programa es:</p>
<p><img src="imagentema/foto014.jpg" border="0" alt="modulo fs readFile node.io"></p>
<p>Tenemos en pantalla la impresión de las dos líneas del archivo de texto. El módulo 'fs' tiene una función llamada readFile que le pasamos como primer parámetro el nombre del archivo a leer y como segundo parámetro una función anónima que se ejecutará cuando se termine de leer el archivo pasando como parámetros un objeto con la referencia del error si lo hubiera y un objeto de tipo Buffer con todos los datos del archivo de texto.</p>
<p>Para mostrar el contenido del Buffer en formato texto llamamos al método toString(). Si no hacemos esto en pantalla mostrará los valores numéricos de los caracteres.</p>

<p>Nuevamente estamos implementando la lectura de un archivo en forma asincrónica, con el objeto de no detener el hilo de nuestro programa (esto es muy útil si el archivo a leer es de gran tamaño)</p>
<h3>Otra forma de definir la función que se dispara luego de leer o escribir un archivo.</h3>
<p>El empleo de funciones anónimas en JavaScript es muy común pero podemos volver a codificar el problema anterior pasando el nombre de una función:</p>
<p>Modificamos el archivo ejercicio6.js eliminando la función anónima e implementando una función con un nombre explícito:</p>
<pre class="recuadro">
var fs=require('fs');

function leer(error,datos){
    if (error) {
        console.log(error);
    }	
    else {
        console.log(datos.toString());
    }
}

fs.readFile('./archivo1.txt',leer);

console.log('última línea del programa');</pre>
</pre>
<p>Tengamos en cuenta que el resultado es idéntico a la implementación con la función anónima.</p>
<p>No es obligatorio que la implementación de la función esté definida antes de llamar a readFile, podría estar implementada al final:</p>
<pre class="recuadro">
var fs=require('fs');

fs.readFile('./archivo1.txt',leer);

console.log('última línea del programa');

function leer(error,datos){
    if (error) {
        console.log(error);
    }	
    else {
        console.log(datos.toString());
    }
}
</pre>

<p>O inclusive podría estar implementada en otro módulo y requerirla.</p>

<p>El módulo 'fs' tiene muchas funciones más además de crear y leer un archivo como hemos visto como pueden ser borrar, renombrar, crear directorios, borrar directorios, retornar información de archivos etc. para consultar estas funciones podemos visitar <a href="https://nodejs.org/api/fs.html" target="_target"> el api de Node.js</a></p>
<p>En conceptos sucesivos seguiremos utilizando el paquete 'fs' he iremos introduciendo otras funcionalidades.</p><h2><a href="index2904.html?inicio=0">Retornar</a></h2> 

<table width="700px">
<tr>
<td align="left">	

<script type="text/javascript"><!--
google_ad_client = "ca-pub-4669394804436935";
/* fondo-izquierda-grande */
google_ad_slot = "2944336362";
google_ad_width = 336;
google_ad_height = 280;
//-->
</script>
<script type="text/javascript"
src="../../pagead2.googlesyndication.com/pagead/f.txt">
</script>

<script type="text/javascript"><!--
google_ad_client = "ca-pub-4669394804436935";
/* fondo-derecha-grande */
google_ad_slot = "7374535966";
google_ad_width = 336;
google_ad_height = 280;
//-->
</script>
<script type="text/javascript"
src="../../pagead2.googlesyndication.com/pagead/f.txt">
</script>

</td>
</tr>
</table>

</div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-628756-35', 'auto');
  ga('send', 'pageview');

</script>
</body>
<script type="text/javascript">
function cambiar()
{
  var lista=document.getElementsByTagName('pre');
  for(f=0;f<lista.length;f++)
  {
   lista[f].style.display='block';
  }
  document.getElementById('solucion').style.display='none';
}

</script>




<!-- Mirrored from www.javascriptya.com.ar/nodejsya/detalleconcepto.php?punto=4&codigo=4&inicio=0 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 15 Sep 2015 14:49:39 GMT -->
</html>
