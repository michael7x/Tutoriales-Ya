

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<!-- Mirrored from www.mysqlya.com.ar/problemas/problema.php?inicio=21&cod=38&punto=39 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 15 Sep 2015 15:10:28 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=ISO-8859-1" /><!-- /Added by HTTrack -->
<head>
<title>Problemas propuestos:Clave primaria compuesta.</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../css/estilos.css" rel="stylesheet" type="text/css">

<style>
html,body {
	background-color: #D3E9D0;
	font-family: Trebuchet MS, Verdana, Arial, sans-serif;
	font-size: 10pt;
	text-align:center;
}

h1 {
	font-size: 14pt;
	margin: 0%;
}
pre {
  text-align:left;
  font-family:verdana,sans-serif;
}
.recuadro {
background-color:#ffffcc;
  text-align:left;
  font-family:verdana;

  border-width:0;
  padding:5px;

  border: 1px dotted #ffaa00;
}
</style>

<script language="JavaScript">
function abrirVentana()
{
  alto=(screen.availHeight/2)+100;
  ancho=screen.availWidth-10;	
  window.open('', 'ventanaForm', 'top=0,left=0,width='+ancho+',height='+alto+',resizable=yes,scrollbars=yes,menubar=no,status=yes,toolbar=yes,location=yes');  	
}

function VentanaTeorico(codigo)
{
  alto=400;
  window.open('../temarios/descripcion2ade4.html?cod='+codigo+'&origen=problema', '', 'top=0,left=0,width=800,height='+alto+',resizable=yes,scrollbars=yes,menubar=no');  	
}


</script>

</head>

<body>


<div class="upperleft">
  <div class="upperright">
    <div class="lowerleft">
      <div class="lowerright">

<table width="98%">
<tr>
<td> 
<h1>39 - Clave primaria compuesta.</h1></td>
<td align="right">
<!--<a href="http://www.mysqlya.com.ar/publicidad/"><img border="0" style="margin:5px;padding-left:2px" src="../imagenes/publicidad.png"></a>	-->
</td>
</tr>
</table>

      </div>
    </div>
  </div>
</div>

<br>
<div class="upperleft">
  <div class="upperright">
    <div class="lowerleft">
      <div class="lowerright">
<table>
<tr>
<td align="left">
<script type="text/javascript"><!--
google_ad_client = "pub-4669394804436935";
/* 728x90, creado 1/09/10 - largo */
google_ad_slot = "4269167522";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="../../pagead2.googlesyndication.com/pagead/f.txt">
</script>
</td>
</tr>
</table>		  

<b>Problema: </b><br><pre>
 Una pequeña biblioteca de barrio registra los préstamos de sus libros en una tabla 
llamada "prestamos". En ella almacena la siguiente información:
 -título del libro,
 -documento de identidad del socio a quien se le presta el libro,
 -fecha de préstamo,
 -fecha de devolución del libro,
 -devuelto: si el libro ha sido o no devuelto.

1- Elimine la tabla "prestamos" si existe.

2- Necesitamos una clave que identifique cada registro en la tabla "prestamos". El mismo libro no 
puede prestarse en la misma fecha.

3- Cree la tabla:
 create table prestamos(
  titulo varchar(40) not null,
  documento char(8) not null,
  fechaprestamo date not null,
  fechadevolucion date,
  devuelto char(1) default 'N',
  primary key(titulo,fechaprestamo)
 );

4- Ingrese los siguientes registros para la tabla "prestamos":
 insert into prestamos (titulo,documento,fechaprestamo)
  values('Manual de 1 grado','22333444','2006-07-10');
 insert into prestamos (titulo,documento,fechaprestamo)
  values('Manual de 1 grado','22333444','2006-07-20');
 insert into prestamos (titulo,documento,fechaprestamo)
  values('Manual de 1 grado','23333444','2006-07-15');
 insert into prestamos (titulo,documento,fechaprestamo)
  values('El aleph','22333444','2006-07-10');
 insert into prestamos (titulo,documento,fechaprestamo)
  values('El aleph','30333444','2006-08-10');
Note que un mismo libro fue prestado a un mismo socio pero en una fecha distinta.

5- Intente ingresar un valor de clave primaria repetida:
 insert into prestamos (titulo,documento,fechaprestamo)
  values('Manual de 1 grado','25333444','2006-07-10');
</pre><form name="formulario" action="http://www.mysqlya.com.ar/simulador/ejecuta.php" target="ventanaForm" 
onsubmit="abrirVentana()" method="post" >
           
          <textarea class="programafuente" name="programa" rows=15 cols=110 wrap="off"></textarea>
    <br>
 <input type="submit"  value="Ejecutar  los comandos SQL">

    <input type="button" onClick="javascript:formulario.programa.value=''" value="Borrar comando.">
<input type="button" onClick="javascript:history.back()" name="cancelar" value="Finalizar">

    <br>
	<br>

<table width="700px">
<tr>
<td align="left">	

<script type="text/javascript"><!--
google_ad_client = "ca-pub-4669394804436935";
/* fondo-izquierda-grande */
google_ad_slot = "2944336362";
google_ad_width = 336;
google_ad_height = 280;
//-->
</script>
<script type="text/javascript"
src="../../pagead2.googlesyndication.com/pagead/f.txt">
</script>

<script type="text/javascript"><!--
google_ad_client = "ca-pub-4669394804436935";
/* fondo-derecha-grande */
google_ad_slot = "7374535966";
google_ad_width = 336;
google_ad_height = 280;
//-->
</script>
<script type="text/javascript"
src="../../pagead2.googlesyndication.com/pagead/f.txt">
</script>

</td>
</tr>
</table>


<input type="hidden" name="extension1" value="problema1.php">
<input type="hidden" name="extension2" value="problema1.php">
<input type="hidden" name="extension3" value="problema1.php">

</form>
        <p>&nbsp;</p>
  
<table width="650px">
<tr>
<td align="center">	



</td>
</tr>
</table>		
	
	

<b>Otros problemas: </b><br><pre>
A) Un consultorio médico en el cual trabajan 3 médicos registra las consultas de los pacientes en 
una tabla llamada "consultas".

1- Elimine la tabla si existe.

2- La tabla contiene los siguientes datos:
  - fechayhora: datetime not null, fecha y hora de la consulta,
  - medico: varchar(30), not null, nombre del médico (Perez,Lopez,Duarte),
  - documento: char(8) not null, documento del paciente,
  - paciente: varchar(30), nombre del paciente,
  - obrasocial: varchar(30), nombre de la obra social ('IPAM','PAMI').
 );

3- Un médico sólo puede atender a un paciente en una fecha y hora determianada. En una fecha y hora 
determinada, varios médicos atienden a distintos pacientes. Cree la tabla definiendo una clave 
primaria compuesta:
 create table consultas(
  fechayhora datetime not null,
  medico varchar(30) not null,
  documento char(8) not null,
  paciente varchar(30),
  obrasocial varchar(30),
  primary key(fechayhora,medico)
 );

4- Ingrese varias consultas para un mismo médico en distintas horas el mismo día.

5- Ingrese varias consultas para diferentes médicos en la misma fecha y hora.

6- Intente ingresar una consulta para un mismo médico en la misma hora el mismo día.


B) Un club dicta clases de distintos deportes. En una tabla llamada "inscriptos" almacena la 
información necesaria.

1- Elimine la tabla "inscriptos" si existe.

2- La tabla contiene los siguientes campos:
 - documento del socio alumno: char(8) not null
 - nombre del socio: varchar(30),
 - nombre del deporte (tenis, futbol, natación, basquet): varchar(15) not null,
 - año de inscripcion: year,
 - matrícula: si la matrícula ha sido o no pagada ('s' o 'n').

3- Necesitamos una clave primaria que identifique cada registro. Un socio puede inscribirse en 
varios deportes en distintos años. Un socio no puede inscribirse en el mismo deporte el mismo año. 
varios socios se inscriben en un mismo deporte. Cree la tabla con una clave compuesta:
 create table inscriptos(
  documento char(8) not null, 
  nombre varchar(30),
  deporte varchar(15) not null,
  año year,
  matricula char(1),
  primary key(documento,deporte,año)
 );

4- Inscriba a varios alumnos en el mismo deporte en el mismo año.

5- Inscriba a un mismo alumno en varios deportes en el mismo año.

6- Ingrese un registro con el mismo documento de socio en el mismo deporte en distintos años.

7- Intente inscribir a un socio alumno en un deporte en el cual ya esté inscripto en un año en el 
cual ya se haya inscripto.

8- Intente eliminar un campo parte de la clave.


C) Un comercio guarda la información de sus ventas en una tabla llamada "facturas".

1- Elimine la tabla si existe.

2- Intente crear la tabla con la siguiente estructura:
 create table facturas(
  serie char(1) not null,
  numero int(10) zerofill auto_increment,
  descripcion varchar(30),
  precioporunidad decimal(5,2) unsigned,
  cantidad tinyint unsigned,
  primary key (serie,numero) 
 );

3- Aparece un mensaje de error, la tabla no puede ser creada porque el campo definido 
como "auto_increment" es secundario (primero está "serie") y sabemos que un campo "auto_increment" 
debe estar primero en orden al ser definido parte de la clave compuesta.

4- Cree la tabla cambiando el orden de los campos estabecidos como clave primaria:
 create table facturas(
  serie char(1) not null,
  numero int(10) zerofill auto_increment,
  numeroitem smallint unsigned not null,
  descripcion varchar(30),
  precioporunidad decimal(5,2) unsigned,
  cantidad tinyint unsigned,
  primary key (numero,serie,numeroitem) 
 );
Tenga en cuenta al ingresar registros que el campo "numero" se autoincrementará sin tener en cuenta 
los demás campos.

5- Ingrese 3 registros con igual "serie", "numero" y distintos números de items:
 insert into facturas (serie,numero,numeroitem,descripcion,precioporunidad,cantidad)
  values('A',100,1,'escuadra 20 cm.',2.50,20);
 insert into facturas (serie,numero,numeroitem,descripcion,precioporunidad,cantidad)
  values('A',100,2,'escuadra 50 cm.',5,30);
 insert into facturas (serie,numero,numeroitem,descripcion,precioporunidad,cantidad)
  values('A',100,3,'goma lapiz-tinta',0.35,100);

6- Ingrese los siguientes registros:
 insert into facturas (serie,numero,numeroitem,descripcion,precioporunidad,cantidad)
  values('A',102,1,'lapices coloresx6',4.40,50);
 insert into facturas (serie,numero,numeroitem,descripcion,precioporunidad,cantidad)
  values('A',102,2,'lapices coloresx12',8,60);
 insert into facturas (serie,numero,numeroitem,descripcion,precioporunidad,cantidad)
  values('B',102,1,'lapices coloresx24',12.35,100);
 insert into facturas (serie,numero,numeroitem,descripcion,precioporunidad,cantidad)
  values('B',102,2,'goma lapiz-tinta',0.35,200);

7- Ingrese los siguientes registros y vea qué valor da al "numero" que no se ingresa:
 insert into facturas (serie,numeroitem,descripcion,precioporunidad,cantidad)
  values('A',1,'compas plastico',12,50);
 insert into facturas (serie,numeroitem,descripcion,precioporunidad,cantidad)
  values('A',1,'compas metal',18.90,80);

8- Intente ingresar un registro con valores de clave repetida:
insert into facturas (serie,numero,numeroitem,descripcion,precioporunidad,cantidad)
  values('A',104,1,'compas metal',18.90,80);

9- Muestre los registros concatenando "serie" con "numero", usando un alias para esa columna, 
muestre los demás campos y ordene por el alias:
 select concat_ws('-',serie,numero) as serienumero,
  numeroitem,descripcion,precioporunidad,cantidad
  from facturas
  order by serienumero;

10- Agrupe los registros por serie y número de factura y muestre el total (en una columna 
calculada) de cada factura:
 select serie,numero,
  sum(precioporunidad*cantidad) as total
  from facturas
  group by serie,numero;
</pre>
<br>
   <h2><a href="../index10fd.html?inicio=21">Retornar</a></h2>   


      </div>
    </div>
  </div>
</div>

<br>


<script src="../../www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-628756-5";
urchinTracker();
</script>

</body>

<!-- Mirrored from www.mysqlya.com.ar/problemas/problema.php?inicio=21&cod=38&punto=39 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 15 Sep 2015 15:10:28 GMT -->
</html>
