

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<!-- Mirrored from www.oracleya.com.ar/problemas/problema.php?inicio=50&cod=225&punto=67 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 15 Sep 2015 15:10:36 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=ISO-8859-1" /><!-- /Added by HTTrack -->
<head>
<title>Ejercicios propuestos : Minus(Oracle)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="keywords" content="oracle, programación, sql, tutorial">
<meta name="description" content="El objetivo de este tutorial 
es presentar los conceptos básicos de Oracle.">
<meta name="author" content="Diego Moisset">
<meta http-equiv="content-type" content="text/html; charset=iso-8859-1">

<link href="../css/estilos.css" rel="stylesheet" type="text/css">

<style>
html,body {
	background-color: #D3E9D0;
	font-family: Trebuchet MS, Verdana, Arial, sans-serif;
	font-size: 10pt;
	text-align:center;
}

h1 {
	font-size: 14pt;
	margin: 0%;
}
pre {
  text-align:left;
  font-family:verdana,sans-serif;
}
.recuadro {
background-color:#ffffcc;
  text-align:left;
  font-family:verdana;

  border-width:0;
  padding:5px;

  border: 1px dotted #ffaa00;
}
.recuadrooculto {
  background-color:#ffffcc;
  text-align:left;
  font-family:verdana;

  border-width:0;
  padding:5px;
  border: 1px dotted #ffaa00;
  display: none;
}

</style>

<script language="JavaScript">
function abrirVentana()
{
  alto=(screen.availHeight/2)+100;
  ancho=screen.availWidth-10;	
  window.open('', 'ventanaForm', 'top=0,left=0,width='+ancho+',height='+alto+',resizable=yes,scrollbars=yes,menubar=no,status=yes,toolbar=yes,location=yes');  	
}

function VentanaTeorico(codigo)
{
  alto=400;
  window.open('../temarios/descripcion2ade4.html?cod='+codigo+'&origen=problema', '', 'top=0,left=0,width=800,height='+alto+',resizable=yes,scrollbars=yes,menubar=no');  	
}

function cambiar(nro)
{
  var lista=document.getElementsByTagName('pre');
  for(f=0;f<lista.length;f++)
  {
   if (nro==1)
   {
     if (lista[f].id=='solu1')
       lista[f].style.display='block';
   }
   else
     if (nro==2)
     {
       if (lista[f].id=='solu2')
         lista[f].style.display='block';
     }
	   
  }
  if (nro==1)
    document.getElementById('solucion1').style.display='none';
  if (nro==2)
    document.getElementById('solucion2').style.display='none';
}

</script>

</head>

<body>
<div class="upperleft">
  <div class="upperright">
    <div class="lowerleft">
      <div class="lowerright">

<table width="98%">
<tr>
<td> 
<h1>67 - Minus</h1></td>
<td align="right">
<!--<a href="http://www.sqlserverya.com.ar/publicidad/"><img border="0" style="margin:5px;padding-left:2px" src="../imagenes/publicidad.png"></a>	-->

</td>
</tr>
</table>

      </div>
    </div>
  </div>
</div>

<br>
<div class="upperleft">
  <div class="upperright">
    <div class="lowerleft">
      <div class="lowerright">
	  <table>
<tr>
<td align="left">
<script type="text/javascript"><!--
google_ad_client = "pub-4669394804436935";
/* 728x90, creado 1/09/10 - largo */
google_ad_slot = "4269167522";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="../../pagead2.googlesyndication.com/pagead/f.txt">
</script>
</td>
</tr>
</table>		  

<b>Primer problema: </b><br><p>Una clínica almacena los datos de los médicos en una tabla llamada "medicos" y los datos de los pacientes en otra denominada "pacientes".</p>
<p>1- Eliminamos ambas tablas:</p>
<pre>
 drop table medicos;
 drop table pacientes;
</pre>
<p>2- Creamos las tablas:</p>
<pre>
 create table medicos(
  legajo number(3),
  documento varchar2(8) not null,
  nombre varchar2(30),
  domicilio varchar2(30),
  especialidad varchar2(30),
  primary key(legajo)
 );

 create table pacientes(
  documento varchar2(8) not null,
  nombre varchar2(30),
  domicilio varchar2(30),
  obrasocial varchar2(20),
  primary key(documento)
 );
</pre>
<p>3- Ingresamos algunos registros:</p>
<pre>
 insert into medicos values(1,'20111222','Ana Acosta','Avellaneda 111','clinica');
 insert into medicos values(2,'21222333','Betina Bustos','Bulnes 222','clinica');
 insert into medicos values(3,'22333444','Carlos Caseros','Colon 333','pediatria');
 insert into medicos values(4,'23444555','Daniel Duarte','Duarte Quiros 444','oculista');
 insert into medicos values(5,'24555666','Estela Esper','Esmeralda 555','alergia');

 insert into pacientes values('24555666','Estela Esper','Esmeralda 555','IPAM');
 insert into pacientes values('23444555','Daniel Duarte','Duarte Quiros 444','OSDOP');
 insert into pacientes values('30111222','Fabiana Fuentes','Famatina 666','PAMI');
 insert into pacientes values('30111222','Gaston Gonzalez','Guemes 777','PAMI');
</pre>
<p>4- La clínica necesita el nombre y domicilio de médicos y pacientes para enviarles una tarjeta de invitación a la inauguración de un nuevo establecimiento. Emplee el operador "union" para obtener dicha información de ambas tablas (7 registros)</p>
<p>5- Se necesitan los nombres de los médicos que también son pacientes de la clínica. Realice una intersección entre las tablas.</p>
<p>6- La clínica necesita los nombres de los pacientes que no son médicos. Realice una operación de resta.</p>
<p>7- Se necesitan los registros que no coinciden en ambas tablas. Realice la operación necesaria.</p>
<a href="javascript:cambiar(1)" id="solucion1">Ver solución</a>
<br><br>
<pre id="solu1" class="recuadrooculto">
 drop table medicos;
 drop table pacientes;

 create table medicos(
  legajo number(3),
  documento varchar2(8) not null,
  nombre varchar2(30),
  domicilio varchar2(30),
  especialidad varchar2(30),
  primary key(legajo)
 );

 create table pacientes(
  documento varchar2(8) not null,
  nombre varchar2(30),
  domicilio varchar2(30),
  obrasocial varchar2(20),
  primary key(documento)
 );

 insert into medicos values(1,'20111222','Ana Acosta','Avellaneda 111','clinica');
 insert into medicos values(2,'21222333','Betina Bustos','Bulnes 222','clinica');
 insert into medicos values(3,'22333444','Carlos Caseros','Colon 333','pediatria');
 insert into medicos values(4,'23444555','Daniel Duarte','Duarte Quiros 444','oculista');
 insert into medicos values(5,'24555666','Estela Esper','Esmeralda 555','alergia');

 insert into pacientes values('24555666','Estela Esper','Esmeralda 555','IPAM');
 insert into pacientes values('23444555','Daniel Duarte','Duarte Quiros 444','OSDOP');
 insert into pacientes values('30111222','Fabiana Fuentes','Famatina 666','PAMI');
 insert into pacientes values('30111222','Gaston Gonzalez','Guemes 777','PAMI');

 select nombre, domicilio from medicos
  union
  select nombre, domicilio from pacientes;

 select nombre from medicos
  intersect
  select nombre from pacientes;

 select nombre, domicilio from pacientes
  minus
  select nombre, domicilio from medicos;

 select nombre from pacientes
  minus
  select nombre from medicos
 union
 (select nombre from medicos
  minus
  select nombre from pacientes);
</pre>
        <p>&nbsp;</p>
  
<table width="700px">
<tr>
<td align="left">	

<script type="text/javascript"><!--
google_ad_client = "ca-pub-4669394804436935";
/* fondo-izquierda-grande */
google_ad_slot = "2944336362";
google_ad_width = 336;
google_ad_height = 280;
//-->
</script>
<script type="text/javascript"
src="../../pagead2.googlesyndication.com/pagead/f.txt">
</script>

<script type="text/javascript"><!--
google_ad_client = "ca-pub-4669394804436935";
/* fondo-derecha-grande */
google_ad_slot = "7374535966";
google_ad_width = 336;
google_ad_height = 280;
//-->
</script>
<script type="text/javascript"
src="../../pagead2.googlesyndication.com/pagead/f.txt">
</script>

</td>
</tr>
</table>
	
	

<b>Segundo problema: </b><br><p>Un colegio guarda los datos de los alumnos que están cursando primer año en una tabla denominada "primero", los datos de los alumnos que están cursando segundo año en una tabla llamada "segundo" y en la tabla "inscriptos2" los datos de los alumnos inscriptos para segundo año para el siguiente año.</p>

<p>1- Elimine las tablas:</p>
<pre>
 drop table primero;
 drop table segundo;
 drop table inscriptos2;
</pre>
<p>2- Cree las tablas:</p>
<pre>
 create table primero(
  documento char(8) not null,
  nombre varchar2(30),
  domicilio varchar2(30),
  primary key(documento)
 );

 create table segundo(
  documento char(8) not null,
  nombre varchar2(30),
  domicilio varchar2(30),
  primary key(documento)
 );

 create table inscriptos2(
  documento char(8) not null,
  nombre varchar2(30),
  domicilio varchar2(30),
  primary key(documento)
 );
</pre>
<p>3- Ingrese algunos registros:</p>
<pre>
 insert into primero values('40111222','Alicia Acosta','Avellaneda 111');
 insert into primero values('41222333','Bernardo Bustos','Bulnes 222');
 insert into primero values('41555666','Carlos Caseres','Colon 333');
 insert into primero values('41888999','Diana Duarte','Dinamarca 444');
 insert into primero values('42333444','Eduardo Esper','San Martin 555');

 insert into segundo values('43444555','Federico Fuentes','Francia 666');
 insert into segundo values('43666777','Gabriela Gomez','Garzon 777');
 insert into segundo values('44555666','Hector Huerta','Colon 888');
 insert into segundo values('44999000','Ines Irala','Inglaterra 999');
 insert into segundo values('45111444','Juan Juarez','Jamaica 111');

 insert into inscriptos2 values('41555666','Carlos Caseres','Colon 333');
 insert into inscriptos2 values('41888999','Diana Duarte','Dinamarca 444');
 insert into inscriptos2 values('42333444','Eduardo Esper','San Martin 555');
 insert into inscriptos2 values('43444555','Federico Fuentes','Francia 666');
 insert into inscriptos2 values('46777888','Luis Lopez','Lules 222');
 insert into inscriptos2 values('47888999','Marina Moreno','Martin Garcia 333');
 insert into inscriptos2 values('48999000','Nora Nores','Natividad 333');
</pre>
<p>Tenga en cuenta algunas consideraciones:<br>
- algunos alumnos de primero, se han inscripto en el mismo colegio para cursar segundo año;<br>
- algunos alumnos de primero no están inscriptos en segundo porque repetirán el próximo año o se cambiarán  de colegio;<br>
- algunos alumnos que están cursando segundo están inscriptos nuevamente en segundo porque repetirán el curso;<br>
- algunos inscriptos para el año próximo en segundo, no están cursando primero en este colegio.</p>

<p>4- El colegio quiere saber los nombres de los inscriptos a segundo del año próximo que repiten segundo (presentes en "segundo" y en "inscriptos2") (1 registro):</p>
<p>5- El colegio quiere saber los nombres de los alumnos que están cursando primero y están inscriptos para segundo el próximo año (presentes en "inscriptos2" y en "primero") (3 registros)</p>
<p>6- El colegio quiere saber los nombres y domicilios de los alumnos inscriptos para segundo que no están cursando este año en este colegio (presentes en "inscriptos2" y ausentes en "primero" y "segundo") para enviarles una nota con la fecha para una reunión informativa (3 registros)</p>
<p>7- El colegios quiere saber los nombres de los alumnos inscriptos para segundo el próximo año, que están cursando primero o segundo este año (presentes en "inscriptos2" y en "primero" o "segundo). Realice las operaciones necesarias. (4 registros)</p>
<p>8- El colegio necesita los nombres de los alumnos que están cursando primero y no están inscriptos el próximo año en segundo para enviarles un mail preguntando la razón por la cual no se han anotado aún (2 registros)</p>
<br>
<a href="javascript:cambiar(2)" id="solucion2">Ver solución</a>
<pre id="solu2" class="recuadrooculto">
 drop table primero;
 drop table segundo;
 drop table inscriptos2;

 create table primero(
  documento char(8) not null,
  nombre varchar2(30),
  domicilio varchar2(30),
  primary key(documento)
 );

 create table segundo(
  documento char(8) not null,
  nombre varchar2(30),
  domicilio varchar2(30),
  primary key(documento)
 );

 create table inscriptos2(
  documento char(8) not null,
  nombre varchar2(30),
  domicilio varchar2(30),
  primary key(documento)
 );

 insert into primero values('40111222','Alicia Acosta','Avellaneda 111');
 insert into primero values('41222333','Bernardo Bustos','Bulnes 222');
 insert into primero values('41555666','Carlos Caseres','Colon 333');
 insert into primero values('41888999','Diana Duarte','Dinamarca 444');
 insert into primero values('42333444','Eduardo Esper','San Martin 555');

 insert into segundo values('43444555','Federico Fuentes','Francia 666');
 insert into segundo values('43666777','Gabriela Gomez','Garzon 777');
 insert into segundo values('44555666','Hector Huerta','Colon 888');
 insert into segundo values('44999000','Ines Irala','Inglaterra 999');
 insert into segundo values('45111444','Juan Juarez','Jamaica 111');

 insert into inscriptos2 values('41555666','Carlos Caseres','Colon 333');
 insert into inscriptos2 values('41888999','Diana Duarte','Dinamarca 444');
 insert into inscriptos2 values('42333444','Eduardo Esper','San Martin 555');
 insert into inscriptos2 values('43444555','Federico Fuentes','Francia 666');
 insert into inscriptos2 values('46777888','Luis Lopez','Lules 222');
 insert into inscriptos2 values('47888999','Marina Moreno','Martin Garcia 333');
 insert into inscriptos2 values('48999000','Nora Nores','Natividad 333');

 select nombre from segundo
  intersect
   select nombre from inscriptos2;

 select nombre from inscriptos2
  intersect
 select nombre from primero;

 select nombre from inscriptos2
  minus
   select nombre from primero
  minus
   select nombre from segundo;

 select nombre,domicilio from inscriptos2
  intersect
   select nombre,domicilio from primero
  union
 (select nombre,domicilio from inscriptos2
  intersect
  select nombre,domicilio from segundo);

 select nombre from primero
  minus
 select nombre from inscriptos2;
</pre>

		
<br>
   <h2><a href="../indexefd7.html?inicio=50">Retornar</a></h2>   


      </div>
    </div>
  </div>
</div>



</body>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-628756-18");
pageTracker._trackPageview();
} catch(err) {}</script>

<!-- Mirrored from www.oracleya.com.ar/problemas/problema.php?inicio=50&cod=225&punto=67 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 15 Sep 2015 15:10:36 GMT -->
</html>
