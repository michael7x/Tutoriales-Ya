<html>


<!-- Mirrored from www.sqlserverya.com.ar/temarios/descripcion.php?inicio=100&cod=137&punto=112 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 15 Sep 2015 15:10:33 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=ISO-8859-1" /><!-- /Added by HTTrack -->
<head>
<title>Tutorial de SQL Server </title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="../css/estilos.css" rel="stylesheet" type="text/css">
	  <meta http-equiv="content-type" content="text/html; charset=iso-8859-1">

<style>
html,body {
	background-color: #D3E9D0;
	font-family: Trebuchet MS, Verdana, Arial, sans-serif;
	font-size: 10pt;
	text-align:center;
}

h1 {
	font-size: 14pt;
	margin: 0%;
}


</style>
</head>

<body>

<div class="upperleft">
  <div class="upperright">
    <div class="lowerleft">
      <div class="lowerright">

<table width="98%">
<tr>
<td> 
<h1>112 - Variables de usuario</h1></td>
<td align="right">
<!--<a href="http://www.sqlserverya.com.ar/publicidad/"><img border="0" style="margin:5px;padding-left:2px" src="../imagenes/publicidad.png"></a>	-->

</td>
</tr>
</table>

      </div>
    </div>
  </div>
</div>
<br>


<div class="upperleft">
  <div class="upperright">
    <div class="lowerleft">
      <div class="lowerright">

<div style="display:block;float:left;margin: 5px;"> 
 
<script type="text/javascript"><!--
google_ad_client = "pub-4669394804436935";
/* 300x250, creado 6/11/08 novi */
google_ad_slot = "7481492727";
google_ad_width = 300;
google_ad_height = 250;
//-->
</script>
<script type="text/javascript"
src="../../pagead2.googlesyndication.com/pagead/f.txt">
</script>
 
</div> 	  
<p>
<p>Las variables nos permiten almacenar un valor y recuperarlo más adelante para emplearlos en otras sentencias.</p>
<p>Las variables de usuario son específicas de cada conexión y son liberadas automáticamente al abandonar la conexión.</p>

<p>Las variables de usuario comienzan con "@" (arroba) seguido del nombre (sin espacios), dicho nombre puede contener cualquier caracter.</p>

<p>Una variable debe ser declarada antes de usarse. Una variable local se declara así:</p>
<pre>
 declare @NOMBREVARIABLE TIPO
</pre>
<p>colocando "declare" el nombre de la variable que comienza con el símbolo arroba (@) y el tipo de dato. Ejemplo:</p>
<pre>
 declare @nombre varchar(20)
</pre>

<p>Puede declarar varias variables en una misma sentencia:</p>
<pre>
 declare @nombre varchar(20), @edad int
</pre>

<p>No existen variables globales en SQL Server.</p>

<p>Una variable declarada existe dentro del entorno en que se declara; debemos declarar y emplear la variable en el mismo lote de sentencias, porque si declaramos una variable y luego, en otro bloque de sentencias pretendemos emplearla, dicha variable ya no existe. Por ejemplo, si ejecutamos estas sentencias en diferentes lotes:</p>
 declare @variable varchar(10);

 select @variable;
<p>aparece un mensaje indicando que la variable "@variable" debe ser declarada.</p>
 
<p>Debemos tipear:</p>
<pre>
 declare @variable varchar(10)
 select @variable;
</pre>
<p>Disponemos punto y coma solo al final de la última instrucción del lote.</p>
<p>Una variable a la cual no se le ha asignado un valor contiene "null".</p>
<p>Se le asigna un valor inicial con "set":</p>
<pre>
 set @edad=45
</pre>
<p>Para almacenar un valor en una variable se coloca el signo igual (=) entre la variable y el valor a asignar.</p>

<p>Si le asignamos un valor resultado de una consulta, la sintaxis es:</p>
<pre>
 select @nombre = autor from libros where titulo='Uno'
</pre>

<p>Podemos ver el contenido de una variable con:</p>
<pre>
 select @nombre;
</pre>
<p>Una variable puede tener comodines:</p>
<pre>
 declare @patron varchar(30)
 set @patron='B%'
 select autor
 from libros
  where autor like @patron;
</pre>
<p>La utilidad de las variables consiste en que almacenan valores para utilizarlos en otras consultas.</p>
<p>Por ejemplo, queremos saber todos los datos del libro con mayor precio de la tabla "libros" de una librería. Para ello podemos emplear una variable para almacenar el precio más alto:</p>
<pre>
 declare @mayorprecio
 select @mayorprecio:=max(precio) from libros
</pre>
<p>y luego mostrar todos los datos de dicho libro empleando la variable anterior:</p>
<pre>
 select *from libros
  where precio=@mayorprecio;
</pre>
<p>Es decir, declaramos la variable y guardamos en ella el precio más alto y luego, en otra sentencia, mostramos los datos de todos los libros cuyo precio es igual al valor de la variable.</p> 

<p>Una variable puede ser definida con cualquier tipo de dato, excepto text, ntext e image; incluso de un tipo de dato definido por el usuario.</p>

</p>

<table width="700px">
<tr>
<td align="left">	

<script type="text/javascript"><!--
google_ad_client = "ca-pub-4669394804436935";
/* fondo-izquierda-grande */
google_ad_slot = "2944336362";
google_ad_width = 336;
google_ad_height = 280;
//-->
</script>
<script type="text/javascript"
src="../../pagead2.googlesyndication.com/pagead/f.txt">
</script>

<script type="text/javascript"><!--
google_ad_client = "ca-pub-4669394804436935";
/* fondo-derecha-grande */
google_ad_slot = "7374535966";
google_ad_width = 336;
google_ad_height = 280;
//-->
</script>
<script type="text/javascript"
src="../../pagead2.googlesyndication.com/pagead/f.txt">
</script>

</td>
</tr>
</table>
<br>
   <h2><a href="../indexf6ce.html?inicio=100">Retornar</a></h2>   
      </div>
    </div>
  </div>
</div>

<script src="../../www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-628756-11";
urchinTracker();
</script>


</body>


<!-- Mirrored from www.sqlserverya.com.ar/temarios/descripcion.php?inicio=100&cod=137&punto=112 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 15 Sep 2015 15:10:33 GMT -->
</html>
