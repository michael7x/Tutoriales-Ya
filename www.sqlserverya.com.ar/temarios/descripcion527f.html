<html>


<!-- Mirrored from www.sqlserverya.com.ar/temarios/descripcion.php?inicio=25&cod=42&punto=36 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 15 Sep 2015 15:10:31 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=ISO-8859-1" /><!-- /Added by HTTrack -->
<head>
<title>Tutorial de SQL Server </title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="../css/estilos.css" rel="stylesheet" type="text/css">
	  <meta http-equiv="content-type" content="text/html; charset=iso-8859-1">

<style>
html,body {
	background-color: #D3E9D0;
	font-family: Trebuchet MS, Verdana, Arial, sans-serif;
	font-size: 10pt;
	text-align:center;
}

h1 {
	font-size: 14pt;
	margin: 0%;
}


</style>
</head>

<body>

<div class="upperleft">
  <div class="upperright">
    <div class="lowerleft">
      <div class="lowerright">

<table width="98%">
<tr>
<td> 
<h1>36 - Funciones de agrupamiento (count - sum - min - max - avg)
</h1></td>
<td align="right">
<!--<a href="http://www.sqlserverya.com.ar/publicidad/"><img border="0" style="margin:5px;padding-left:2px" src="../imagenes/publicidad.png"></a>	-->

</td>
</tr>
</table>

      </div>
    </div>
  </div>
</div>
<br>


<div class="upperleft">
  <div class="upperright">
    <div class="lowerleft">
      <div class="lowerright">

<div style="display:block;float:left;margin: 5px;"> 
 
<script type="text/javascript"><!--
google_ad_client = "pub-4669394804436935";
/* 300x250, creado 6/11/08 novi */
google_ad_slot = "7481492727";
google_ad_width = 300;
google_ad_height = 250;
//-->
</script>
<script type="text/javascript"
src="../../pagead2.googlesyndication.com/pagead/f.txt">
</script>
 
</div> 	  
<p>
<p>Hemos visto que SQL Server tiene funciones que nos permiten contar registros, calcular sumas, promedios, obtener valores máximos y mínimos, las funciones de agregado.</p>

<p>Ya hemos aprendido una de ellas, "count()", veamos otras.</p>

<p>Se pueden usar en una instrucción "select" y combinarlas con la cláusula "group by".</p>

<p>Todas estas funciones retornan "null" si ningún registro cumple con la condición del "where", excepto "count" que en tal caso retorna cero.</p>

<p>El tipo de dato del campo determina las funciones que se pueden emplear con ellas.</p>
<p>Las relaciones entre las funciones de agrupamiento y los tipos de datos es la siguiente:</p>
<p>- count: se puede emplear con cualquier tipo de dato.</p>
<p>- min y max: con cualquier tipo de dato.</p>
<p>- sum y avg: sólo en campos de tipo numérico.</p>

<p>La función "sum()" retorna la suma de los valores que contiene el campo especificado. Si queremos saber la cantidad total de libros que tenemos disponibles para la venta, debemos sumar todos los valores del campo "cantidad":</p>
<pre>
 select sum(cantidad)
  from libros;
</pre>
<p>Para averiguar el valor máximo o mínimo de un campo usamos las funciones "max()" y "min()" respectivamente. <br>Queremos saber cuál es el mayor precio de todos los libros:</p>
<pre>
 select max(precio)
  from libros;
</pre>
<p>Entonces, dentro del paréntesis de la función colocamos el nombre del campo del cuál queremos el máximo valor.</p>

<p>La función "avg()" retorna el valor promedio de los valores del campo especificado. Queremos saber el promedio del precio de los libros referentes a "PHP":</p>
<pre>
 select avg(precio)
  from libros
  where titulo like '%PHP%';
</pre>
<p>Ahora podemos entender porque estas funciones se denominan "funciones de agrupamiento", porque operan sobre conjuntos de registros, no con datos individuales.</p>

<p>Tratamiento de los valores nulos:</p>
<p>Si realiza una consulta con la función "count" de un campo que contiene 18 registros, 2 de los cuales contienen valor nulo, el resultado devuelve un total de 16 filas porque no considera aquellos con valor nulo.</p>

<p>Todas las funciones de agregado, excepto "count(*)", excluye los valores nulos de los campos. "count(*)" cuenta todos los registros, incluidos los que contienen "null".</p>

</p>

<table width="700px">
<tr>
<td align="left">	

<script type="text/javascript"><!--
google_ad_client = "ca-pub-4669394804436935";
/* fondo-izquierda-grande */
google_ad_slot = "2944336362";
google_ad_width = 336;
google_ad_height = 280;
//-->
</script>
<script type="text/javascript"
src="../../pagead2.googlesyndication.com/pagead/f.txt">
</script>

<script type="text/javascript"><!--
google_ad_client = "ca-pub-4669394804436935";
/* fondo-derecha-grande */
google_ad_slot = "7374535966";
google_ad_width = 336;
google_ad_height = 280;
//-->
</script>
<script type="text/javascript"
src="../../pagead2.googlesyndication.com/pagead/f.txt">
</script>

</td>
</tr>
</table>
<br>
   <h2><a href="../indexfc77.html?inicio=25">Retornar</a></h2>   
      </div>
    </div>
  </div>
</div>

<script src="../../www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-628756-11";
urchinTracker();
</script>


</body>


<!-- Mirrored from www.sqlserverya.com.ar/temarios/descripcion.php?inicio=25&cod=42&punto=36 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 15 Sep 2015 15:10:31 GMT -->
</html>
